{
  "openapi": "3.0.0",
  "info": {
      "version": "1.0.0",
      "title": "Cattle Keeper",
      "description": "The smart way to keep cattle"
  },
  "servers": [
      {
          "url": "/",
          "description": "Local Dev, or from Heroku"
      },
      {
          "url": "/api/",
          "description": "With docker-compose and nginx proxy"
      }
  ],
  "tags": [
    {
        "name": "User",
        "description": "Manage the users on Cattle Keeper"
    },
    {
      "name": "Country",
      "description": "Manage the countries on Cattle Keeper"
    },
    {
      "name": "Company",
      "description": "Manage the companies on Cattle Keeper"
    },
    {
      "name": "Farm",
      "description": "Manage the farms on Cattle Keeper"
    },
    {
      "name": "Pasture",
      "description": "Manage the pastures on Cattle Keeper"
    },
    {
      "name": "Herd",
      "description": "Manage the herds on Cattle Keeper"
    },
    {
      "name": "Cow",
      "description": "Manage the cattle on Cattle Keeper"
    }
  ],
  "consumes": [
      "application/json"
  ],
  "produces": [
      "application/json"
  ],
  "paths": {
    "/user/{id}": {
        "get": {
          "tags": [
              "User"
          ],
          "summary": "Retrieve a user by id",
          "parameters": [
            {
                "in": "path",
                "name": "id",
                "required": true,
                "description": "User id get retrieve",
                "schema": {
                    "$ref": "#/components/id"
                }
            },
            {
              "$ref": "#/components/jwt"
            }
          ],
          "responses": {
              "200": {
                  "description": "OK",
                  "content" : {
                    "application/json" : {
                      "schema": {
                        "$ref": "#/components/schemas/User"
                      }
                    }
                  }
              },
              "401": {
                "description": "Not Authoried",
                "content" : {
                  "application/json" : {
                    "schema": {
                      "$ref": "#/components/message"
                    }
                  }
                }
            }
          }
        },
        "put": {
          "summary": "Update user with given id",
          "tags": [
              "User"
          ],
          "requestBody": {
              "description": "User Object",
              "required": true,
              "content": {
                "application/json": {
                  "schema": {
                    "$ref": "#/components/schemas/User"
                  }
                }
              }
          },
          "parameters": [
            {
              "in": "path",
              "name": "id",
              "required": true,
              "description": "User with new values of properties",
              "schema": {
                  "$ref": "#/components/id"
              }
            },
            {
              "$ref": "#/components/jwt"
            }
          ],
          "responses": {
            "200": {
              "description": "OK",
              "content" : {
                "application/json" : {
                  "schema": {
                    "$ref": "#/components/schemas/User"
                  }
                }
              }
            },
            "400": {
              "description": "Failed. Bad post data.",
              "content" : {
                "application/json" : {
                  "schema": {
                    "$ref": "#/components/message"
                  }
                }
              }
            },
            "404": {
              "description": "Failed. Cat not found.",
              "content" : {
                "application/json" : {
                  "schema": {
                    "$ref": "#/components/message"
                  }
                }
              }
            }
          }
        }
    },
    "/user": {
      "post": {
        "tags": [
            "User"
        ],
        "summary": "Create a new user in system",
        "requestBody": {
            "description": "User Object",
            "required": true,
            "content": {
                "application/json": {
                    "schema": {
                        "$ref": "#/components/schemas/User"
                    }
                }
            }
        },
        "produces": [
            "application/json"
        ],
        "responses": {
            "200": {
                "description": "OK",
                "content" : {
                  "application/json" : {
                    "schema": {
                      "$ref": "#/components/schemas/User"
                    }
                  }
                }
            },
            "400": {
                "description": "Failed. Bad post data.",
                "content" : {
                  "application/json" : {
                    "schema": {
                      "$ref": "#/components/message"
                    }
                  }
                }
            }
        }
      }
    },
    "/user/login": {
      "post": {
        "tags": [
            "User"
        ],
        "summary": "Log in a new user in system",
        "requestBody": {
            "description": "User email and password",
            "required": true,
            "content": {
                "application/json": {
                    "schema": {
                      "type": "object",
                      "properties": {
                        "email": {
                          "type": "string"
                        },
                        "password": {
                          "type": "string"
                        }
                      }
                    }
                }
            }
        },
        "produces": [
            "application/json"
        ],
        "responses": {
            "200": {
                "description": "OK",
                "content" : {
                  "application/json" : {
                    "schema": {
                      "type": "object",
                      "properties": {
                        "accessToken" : {
                          "type": "string"
                        },
                        "user" : {
                          "$ref": "#/components/schemas/User"
                        },
                        "expiresIn" : {
                          "type": "integer"
                        }
                      }
                    }
                  }
                }
            },
            "400": {
                "description": "Failed. Bad post data.",
                "content" : {
                  "application/json" : {
                    "schema": {
                      "$ref": "#/components/message"
                    }
                  }
                }
            }
        }
      }
    },
    "/user/company/{id}": {
      "post": {
        "tags": [
            "User",
            "Company"
        ],
        "summary": "Get all users at a company",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "description": "Company id",
            "schema": {
                "$ref": "#/components/id"
            }
          },
          {
            "$ref": "#/components/jwt"
          }
        ],
        "produces": [
            "application/json"
        ],
        "responses": {
            "200": {
                "description": "OK",
                "content" : {
                  "application/json" : {
                    "schema": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/User"
                      }
                    }
                  }
                }
            },
            "400": {
                "description": "Failed. Bad post data.",
                "content" : {
                  "application/json" : {
                    "schema": {
                      "$ref": "#/components/message"
                    }
                  }
                }
            }
        }
      }
    },
    "/company/{id}": {
        "get": {
          "tags": [
              "Company"
          ],
          "summary": "Retrieve a company by id",
          "parameters": [
            {
                "in": "path",
                "name": "id",
                "required": true,
                "description": "Company id get retrieve",
                "schema": {
                    "$ref": "#/components/id"
                }
            },
            {
              "$ref": "#/components/jwt"
            }
          ],
          "responses": {
            "200": {
                "description": "OK",
                "content" : {
                  "application/json" : {
                    "schema": {
                      "$ref": "#/components/schemas/Company"
                    }
                  }
                }
            },
            "401": {
              "description": "Not Authorised",
              "content" : {
                "application/json" : {
                  "schema": {
                    "$ref": "#/components/message"
                  }
                }
              }
            }
          }
        },
        "put": {
          "summary": "Update comapny with given id",
          "tags": [
              "Company"
          ],
          "requestBody": {
              "description": "Company Object",
              "required": true,
              "content": {
                "application/json": {
                  "schema": {
                    "$ref": "#/components/schemas/Company"
                  }
                }
              }
          },
          "parameters": [
            {
              "in": "path",
              "name": "id",
              "required": true,
              "description": "Company with new values of properties",
              "schema": {
                  "$ref": "#/components/id"
              }
            },
            {
              "$ref": "#/components/jwt"
            }
          ],
          "responses": {
            "200": {
              "description": "OK",
              "content" : {
                "application/json" : {
                  "schema": {
                    "$ref": "#/components/schemas/Company"
                  }
                }
              }
            },
            "400": {
              "description": "Failed. Bad post data.",
              "content" : {
                "application/json" : {
                  "schema": {
                    "$ref": "#/components/message"
                  }
                }
              }
            },
            "404": {
              "description": "Failed. Cat not found.",
              "content" : {
                "application/json" : {
                  "schema": {
                    "$ref": "#/components/message"
                  }
                }
              }
            }
          }
        }
    },
    "/company": {
      "post": {
        "tags": [
            "Company"
        ],
        "summary": "Create a new company in system",
        "requestBody": {
            "description": "User Object",
            "required": true,
            "content": {
                "application/json": {
                    "schema": {
                        "$ref": "#/components/schemas/Company"
                    }
                }
            }
        },
        "produces": [
            "application/json"
        ],
        "responses": {
            "200": {
                "description": "OK",
                "content" : {
                  "application/json" : {
                    "schema": {
                      "$ref": "#/components/schemas/Company"
                    }
                  }
                }
            },
            "400": {
                "description": "Failed. Bad post data."
            }
        }
     }
    },
    "/farm/{id}": {
      "get": {
        "tags": [
            "Farm"
        ],
        "summary": "Retrieve a farm by id",
        "parameters": [
          {
              "in": "path",
              "name": "id",
              "required": true,
              "description": "Farm id get retrieve",
              "schema": {
                  "$ref": "#/components/id"
              }
          },
          {
            "$ref": "#/components/jwt"
          }
        ],
        "responses": {
          "200": {
              "description": "OK",
              "content" : {
                "application/json" : {
                  "schema": {
                    "$ref": "#/components/schemas/Farm"
                  }
                }
              }
          },
          "401": {
            "description": "Not Authorised",
            "content" : {
              "application/json" : {
                "schema": {
                  "$ref": "#/components/message"
                }
              }
            }
          }
        }
      },
      "put": {
        "summary": "Update farm with given id",
        "tags": [
            "Farm"
        ],
        "requestBody": {
            "description": "Farm Object",
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Farm"
                }
              }
            }
        },
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "description": "Farm with new values of properties",
            "schema": {
                "$ref": "#/components/id"
            }
          },
          {
            "$ref": "#/components/jwt"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content" : {
              "application/json" : {
                "schema": {
                  "$ref": "#/components/schemas/Farm"
                }
              }
            }
          },
          "400": {
            "description": "Failed. Bad post data.",
            "content" : {
              "application/json" : {
                "schema": {
                  "$ref": "#/components/message"
                }
              }
            }
          },
          "404": {
            "description": "Failed. Cat not found.",
            "content" : {
              "application/json" : {
                "schema": {
                  "$ref": "#/components/message"
                }
              }
            }
          }
        }
      }
    },
    "/farm": {
      "post": {
        "tags": [
            "Farm"
        ],
        "summary": "Create a new farm in system",
        "requestBody": {
            "description": "Farm Object",
            "required": true,
            "content": {
                "application/json": {
                    "schema": {
                        "$ref": "#/components/schemas/Farm"
                    }
                }
            }
        },
        "produces": [
            "application/json"
        ],
        "responses": {
            "200": {
                "description": "OK",
                "content" : {
                  "application/json" : {
                    "schema": {
                      "$ref": "#/components/schemas/Farm"
                    }
                  }
                }
            },
            "400": {
                "description": "Failed. Bad post data."
            }
        }
    }
    },
    "/farm/company/{id}": {
      "post": {
        "tags": [
            "Farm",
            "Company"
        ],
        "summary": "Gett all farms at a company",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "description": "Farm id",
            "schema": {
                "$ref": "#/components/id"
            }
          },
          {
            "$ref": "#/components/jwt"
          }
        ],
        "produces": [
            "application/json"
        ],
        "responses": {
            "200": {
                "description": "OK",
                "content" : {
                  "application/json" : {
                    "schema": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Farm"
                      }
                    }
                  }
                }
            },
            "400": {
                "description": "Failed. Bad post data.",
                "content" : {
                  "application/json" : {
                    "schema": {
                      "$ref": "#/components/message"
                    }
                  }
                }
            }
        }
      }
    }
  },
  "components": {
    "jwt": {
      "in": "header",
      "name": "Authorization",
      "required": true,
      "description": "JSON Web Token",
      "schema": {
          "$ref": "#/components/auth"
      }
    },
    "message" : {
      "properties": {
        "msg": {
            "type": "string"
        }
      }
    },
    "id": {
      "type": "string"
    },
    "auth": {
      "properties": {
          "Bearer": {
              "type": "string"
          }
      }
    },
    "schemas": {
      "Company": {
          "type": "object",
          "properties": {
              "_id": {
                  "type": "string"
              },
              "country_id": {
                  "type": "string"
              },
              "name": {
                  "type": "string"
              },
              "description": {
                  "type": "string"
              }
          }
      },
      "User": {
        "type": "object",
        "properties": {
            "_id": {
              "type": "string"
            },
            "company_id": {
              "type": "string"
            },
            "country_id": {
              "type": "string"
            },
            "name": {
              "type": "string"
            },
            "surname": {
              "type": "string"
            },
            "email": {
              "type": "string"
            },
            "password": {
              "type": "string"
            }
        }
      },
      "Farm": {
        "type": "object",
        "properties": {
          "_id": {
            "type": "string"
          },
          "company_id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "location": {
            "type": "string"
          }
        }
      }
    }
  }
}